<div class="card">
  <div class="page-header">
    <div>
      <h2>Warehouses</h2>
      <p class="muted">Manage warehouse locations and availability routing.</p>
    </div>
    <div class="page-actions">
      <a class="btn" href="/admin/warehouses/new">New warehouse</a>
      <a class="btn secondary" href="<%= admin_root_path %>">Admin home</a>
    </div>
  </div>

  <form method="get" action="<%= admin_warehouses_path %>" class="row mt-10">
    <label>
      Search<br>
      <input name="q" value="<%= @q.to_s %>" placeholder="code/name/location">
    </label>
    <label>
      Location<br>
      <select name="location">
        <option value="">All</option>
        <% warehouse_locations.each do |loc| %>
          <option value="<%= loc %>" <%= "selected" if loc == @location %>><%= loc %></option>
        <% end %>
      </select>
    </label>
    <input type="hidden" name="per" value="<%= @per.to_i %>">
    <button type="submit">Filter</button>
    <a class="muted" href="<%= admin_warehouses_path %>">Clear</a>
  </form>

  <p class="muted mt-8">
    Showing <strong><%= @warehouses.size %></strong> of <strong><%= @total.to_i %></strong>
  </p>

  <% if @warehouses.empty? %>
    <div class="empty mt-10">
      <p class="muted m-0">No warehouses found.</p>
    </div>
  <% else %>
    <table>
      <thead>
        <tr>
          <th>Code</th>
          <th>Name</th>
          <th>Location</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @warehouses.each do |w| %>
          <tr>
            <td><%= w.code %></td>
            <td><%= w.name %></td>
            <td class="muted"><%= w.location %></td>
            <td class="row justify-end">
              <a class="btn secondary" href="/admin/warehouses/<%= w.id %>/edit">Edit</a>
              <form method="post" action="<%= admin_warehouse_path(w) %>" onsubmit="return confirm('Delete this warehouse?');">
                <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
                <input type="hidden" name="_method" value="delete">
                <button type="submit" class="secondary">Delete</button>
              </form>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>

  <div class="row justify-between mt-10">
    <% if @page.to_i > 1 %>
      <a class="muted" href="<%= admin_warehouses_path(q: @q, location: @location, page: (@page.to_i - 1), per: @per) %>">← Prev</a>
    <% else %>
      <span></span>
    <% end %>

    <% if (@page.to_i * @per.to_i) < @total.to_i %>
      <a class="muted" href="<%= admin_warehouses_path(q: @q, location: @location, page: (@page.to_i + 1), per: @per) %>">Next →</a>
    <% end %>
  </div>
</div>


